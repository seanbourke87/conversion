<style>
    .CONV-POL-2-1 form .formsect:nth-child(3):not(.cv-show),
    .CONV-POL-2-1 form .formsect:nth-child(4):not(.cv-show),
    .CONV-POL-2-1 #permissions:not(.cv-show),
    .CONV-POL-2-1 #tcs:not(.cv-show),
    .CONV-POL-2-1 button#submitBtn:not(.cv-show) {
        display: none;
    }

    .CONV-POL-2-1 form .formsect:nth-child(3).cv-show,
    .CONV-POL-2-1 form .formsect:nth-child(4).cv-show,
    .CONV-POL-2-1 #permissions.cv-show,
    .CONV-POL-2-1 #tcs.cv-show,
    .CONV-POL-2-1 button#submitBtn.cv-show {
        display: block;
    }

    .cv_2-1_steps {
        position: fixed;
        width: 100%;
        height: 188px;
        left: 0;
        z-index: 999;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #f3f3f3;
        top: -190px;
        transition: top 0.5s ease;
    }

    .cv_2-1_steps.cv-show {
        top: 0;
    }

    .cv_2-1_steps .cv-steps-content {
        margin: 0 auto;
        display: inline-block;
        position: relative;
        z-index: 999;
        min-width: 250px;
        height: 151px;
        margin-top: 15px;
    }

    .cv_2-1_steps .cv-title {
        font-weight: bold;
        text-align: center;
        font-size: 23px;
        margin: 0 0 16px;
    }

    .cv_2-1_steps .cv-steps {
        position: relative;
        display: flex;
        justify-content: space-between;
    }

    .cv_2-1_steps .cv-steps>div:not(.cv-step-bar) {
        display: inline-block;
        text-align: center;
        width: 60px;
        vertical-align: top;
        z-index: 999;
        position: relative;
    }

    .cv_2-1_steps .cv-step-circle {
        display: flex;
        margin: 0 auto;
        background: transparent;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        justify-content: center;
        align-items: center;
    }

    .cv_2-1_steps .cv-step-circle>div {
        display: flex;
        margin: 0 auto;
        color: #000;
        width: 31px;
        height: 31px;
        justify-content: center;
        align-items: center;
        text-align: center;
        background: #fff;
        border: 1px solid #000;
        border-radius: 50%;
        font-weight: bold;
        font-size: 16px;
    }

    .cv_2-1_steps .cv-steps>div:not(.cv-step-bar)>p {
        margin: 7px 0 0;
        line-height: 18px;
        display: none;
    }

    .cv_2-1_steps .cv-steps .cv-step-bar {
        position: absolute;
        top: 17px;
        width: 78%;
        left: 11%;
        height: 3px;
    }

    .cv_2-1_steps .cv-steps .cv-step-bar .cv-step-bar-background {
        display: block;
        margin-top: 1px;
        width: 100%;
        background: #000;
        height: 1px;
    }

    .cv_2-1_steps .cv-steps .cv-step-bar .cv-step-bar-progress {
        display: block;
        width: 27%;
        background: #d00f39;
        height: 3px;
        position: absolute;
        border-radius: 20px;
    }

    .cv_2-1_steps .cv-steps.cv-steps-2 .cv-step-bar .cv-step-bar-progress {
        width: 76%;
    }

    .cv_2-1_steps .cv-steps.cv-steps-3 .cv-step-bar .cv-step-bar-progress {
        width: 100%;
    }

    .cv_2-1_steps .cv-steps .cv-step-1 .cv-step-circle:after,
    .cv_2-1_steps .cv-steps:not(.cv-steps-1) .cv-step-2 .cv-step-circle:after,
    .cv_2-1_steps .cv-steps:not(.cv-steps-1):not(.cv-steps-2) .cv-step-3 .cv-step-circle:after {
        content: '';
        position: absolute;
        width: 35px;
        height: 34.2px;
        display: block;
        border-radius: 50%;
        z-index: 1;
        border: 2.5px solid #d00f39;
        top: auto;
        left: calc(50% - 20px);
    }

    .cv_2-1_steps .cv-steps:not(.cv-steps-1) .cv-step-2 .cv-step-circle:after {
        width: 34.2px;
    }

    .cv_2-1_steps .cv-steps .cv-step-1 .cv-step-circle>div,
    .cv_2-1_steps .cv-steps:not(.cv-steps-1) .cv-step-2 .cv-step-circle>div,
    .cv_2-1_steps .cv-steps:not(.cv-steps-1):not(.cv-steps-2) .cv-step-3 .cv-step-circle>div {
        background: #d00f39;
        border: 2px solid #fff;
        color: #fff;
    }

    .cv_2-1_steps .cv-steps .cv-step-1>p,
    .cv_2-1_steps .cv-steps:not(.cv-steps-1) .cv-step-2>p,
    .cv_2-1_steps .cv-steps:not(.cv-steps-1):not(.cv-steps-2) .cv-step-3>p {
        display: block !important;
    }

    @media only screen and (max-width: 767px) {}
</style>
<script>
    window.springBoard = window.springBoard || {};

    window.springBoard.on = function (eventType, selector, action) {
        document.addEventListener(eventType, function (e) {
            var target = e.target;
            if (target.matches(selector)) {
                action(e);
            } else {
                while (target && target.parentNode !== document) {
                    target = target.parentNode;
                    if (!target) { return; } // If element doesn't exist

                    if (target.matches(selector)) {
                        action(e);
                    }
                }
            }
        });
    };

    // JS code goes here
    var cvTarget1;
    var cvTarget2;
    var cvTarget3;
    var cvTarget4;
    var cvTarget5;
    var cvTargetButton;

    var firstName;
    var lastName;
    var dob1;
    var dob2;
    var dob3;
    var email;

    var currentAddress;

    // Space Between utility functions
    !(function init(name, definition) {
        window.OptimisationExperiment = window.OptimisationExperiment || {}, window.OptimisationExperiment[name] =
            definition();
    }('Utils', function setup() {

        function Constructor(config) {
            this.name = config.name;
            this.id = config.id;
            this.page = config.page;
            this.log = config.log;
            this.modernBrowser = !!(
                typeof Intl == 'object' && Intl && typeof Intl.NumberFormat == 'function' &&
                'requestAnimationFrame' in window &&
                'MutationObserver' in window &&
                'matchMedia' in window &&
                'addEventListener' in document &&
                'classList' in document.createElement('div') &&
                (typeof Element.prototype.matches === 'function' || typeof Element.prototype
                    .msMatchesSelector === 'function')
            );
        }

        Constructor.prototype.logger = function (data) {
            if (!this.modernBrowser) return;

            if (this.log === 'console') {
                console.log('[' + this.name + ']', data);
            } else if (this.log === 'alert') {
                alert('[' + this.name + '] ' + data);
            } else if (this.log === 'satellite') {
                window._satellite && typeof window._satellite.notify === 'function' && window._satellite
                    .notify('[' + this.name + '] ' + data, 4);
            }

        };

        Constructor.prototype.getClosestElement = function (data) {
            if (!this.modernBrowser) return;

            var node = data.node;
            var selector = data.selector;

            try {
                return node.closest(selector);
            } catch (e) {
                if (typeof Element.prototype.msMatchesSelector === 'function') {
                    while (node) {
                        if (Element.prototype.msMatchesSelector.call(node, selector)) return node;
                        else node = 'SVGElement' in window && node instanceof SVGElement ? node.parentNode :
                            node.parentElement;
                    }
                }
            }

            return null;

        };

        Constructor.prototype.getCookieValue = function (data) {
            if (!this.modernBrowser) return;

            var cookie = document.cookie.match('(^|[^;]+)\\s*' + data + '\\s*=\\s*([^;]+)');
            return cookie ? cookie.pop() : '';
        };

        Constructor.prototype.getNestedValue = function (data) {
            if (!this.modernBrowser) return;

            var parts = data.property.split('.');
            var value = data.object || window;

            for (var i = 0, len = parts.length; i < len; i++) {
                if (!value.hasOwnProperty(parts[i])) {
                    return false;
                }

                value = value[parts[i]];
            }

            return value;
        };

        Constructor.prototype.waitUntilTrue = function (data) {
            if (!this.modernBrowser) return;

            var that = this;
            this.addStyleSheet({
                rule: data.hide + ' {opacity:0 !important; visibility: hidden !important}'
            });

            if (data.ready === 'document') {
                if (document.readyState === 'interactive' || document.readyState === 'complete') {
                    checker();
                } else {
                    document.addEventListener('DOMContentLoaded', checker);
                }
            } else if (data.ready == 'window') {
                window.addEventListener('load', checker);
            } else {
                checker();
            }

            function checker() {
                that.checkFunctions({
                    repeat: data.repeat,
                    checker: data.checker,
                    success: data.success,
                    stopper: data.stopper,
                    fail: data.fail,
                    timeout: data.timeout,
                    isTimeUp: false,
                });
            }
        };

        Constructor.prototype.checkFunctions = function (data) {
            if (!this.modernBrowser) return;

            var that = this;
            window.setTimeout(function () {
                data.isTimeUp = true;
            }, data.timeout);

            !(function checking() {
                if (window[that.id] === true || window[that.id] === false || data.isTimeUp || (data
                    .stopper && data.stopper())) {
                    return that.catchFunction({
                        fn: data.fail,
                        value: false,
                        repeat: data.repeat
                    });
                }
                if (data.checker()) {
                    return that.catchFunction({
                        fn: data.success,
                        value: true,
                        repeat: data.repeat
                    });

                }
                window.requestAnimationFrame(checking);
            }());
        };

        Constructor.prototype.addStyleSheet = function (data) {
            if (!this.modernBrowser) return;

            var style = document.createElement('style');
            style.id = this.id;
            style.dataset.experimentName = this.name;
            style.textContent = data.rule;
            document.head.appendChild(style);
        };

        Constructor.prototype.removeStyleSheet = function () {
            if (!this.modernBrowser) return;

            var css = '#' + this.id + '[data-experiment-name="' + this.name + '"]';
            var style = document.querySelectorAll(css);
            for (var i = 0, len = style.length; i < len; i++) {
                style[i].parentNode.removeChild(style[i]);
            }
        };

        Constructor.prototype.catchFunction = function (data) {
            if (!this.modernBrowser) return;

            try {
                data.fn.apply(null);
            } catch (e) {
                e.message = 'Error in ' + this.name + ': ' + e.message;
                console.warn(e);
            } finally {
                if (!data.repeat) window[this.id] = data.value;
                this.removeStyleSheet();
            }
        };

        return Constructor;

    }));

    // Space Between integration functions for Analytics and SessionCam
    !(function init(name, definition) {
        window.OptimisationExperiment = window.OptimisationExperiment || {}, window.OptimisationExperiment[name] =
            definition();
    }('Integrations', function setup() {

        function Constructor(config) {
            this.name = function () {
                if (this.isPreviewMode()) {
                    return '[QA] ' + config.name;
                }

                return config.name;
            };
            this.page = function () {
                if (config.page) {
                    return config.page;
                }

                if (window.tmParam && window.tmParam.page_name) {
                    var name = window.tmParam.page_name;
                    return name.replace(/[\[\]]/g, '');
                }

                return undefined;
            };
            this.id = config.id;
            this.redirect = config.redirect;
            this.isRedirectPage = /adobe_mc_sdid/i.test(window.location.href);
            this.isPreviewLink = /at_preview_token/i.test(window.location.href);
            this.isPreviewMode = function () {
                if (/(at_preview_token|vwbihpezn)/i.test(window.location.href)) {
                    try {
                        localStorage.setItem('adobe-target-preview-mode-integrations', '[QA]');
                    } catch (e) { }
                    return true;
                }

                try {
                    if (localStorage.getItem('adobe-target-preview-mode-integrations') === '[QA]') {
                        return true;
                    }
                } catch (e) { }

                return false;
            };
        }

        Constructor.prototype.adobeAnalytics = function (data) {
            try {
                if (this.redirect === this.isRedirectPage) {
                    window.s_posc_gi(data.account).tl(this, 'o', data.link || 'Experience Optimisation', {
                        linkTrackVars: 'prop6,prop74,eVar74,prop75,eVar75,list2,prop70,eVar70',
                        linkTrackEvents: 'none',
                        prop6: this.page(),
                        prop74: document.referrer.toLowerCase(),
                        eVar74: document.referrer.toLowerCase(),
                        prop75: (document.location.protocol + '//' + document.location.hostname +
                            document.location.pathname).toLowerCase(),
                        eVar75: document.location.href.toLowerCase(),
                        list2: (data.action ? undefined : this.name()),
                        prop70: data.action,
                        eVar70: data.action,
                    });
                }
            } catch (e) { }
        };

        Constructor.prototype.sessionCam = function (data) {
            try {
                if (this.redirect === this.isRedirectPage) {
                    window.sessioncamConfiguration = window.sessioncamConfiguration || {};
                    window.sessioncamConfiguration.customDataObjects = window.sessioncamConfiguration
                        .customDataObjects || [];
                    window.sessioncamConfiguration.customDataObjects.push({
                        key: data.slot,
                        value: this.name()
                    });
                }
            } catch (e) { }
        };

        return Constructor;

    }));

    //
    !(function optimisation(experience) {
        var VARIATION = (function () {
            function experiment() {
                experimentUtils.logger('Variation Code');
                triggerIntegrations();

                // Variation code
                var stickyHTML = '<div class="cv_2-1_steps"> <div class="cv-steps-content"> <p class="cv-title">Credit Card QuickCheck</p> <div class="cv-steps cv-steps-1"> <div class="cv-step-1"><div class="cv-step-circle"><div>1</div></div> <p>About you</p></div> <div class="cv-step-2"><div class="cv-step-circle"><div>2</div></div> <p>Where you live</p></div> <div class="cv-step-3"><div class="cv-step-circle"><div>3</div></div> <p>Work and Finances</p></div> <div class="cv-step-bar"><div class="cv-step-bar-progress"></div><div class="cv-step-bar-background"></div></div> </div> </div> </div>';

                document.querySelector('body').insertAdjacentHTML('beforeEnd', stickyHTML);

                // Show step 2 when step 1 is complete
                var updateToStep2 = function () {
                    document.querySelector('.cv_2-1_steps .cv-steps').classList.remove('cv-steps-1');
                    document.querySelector('.cv_2-1_steps .cv-steps').classList.add('cv-steps-2');
                    document.querySelector('.CONV-POL-2-1 form .formsect:nth-child(3)').classList.add('cv-show');

                    // Tracking
                    window.s_posc_gi('rmgpostofficecoukprod').tl(this, 'o', 'POL 2.1 Completes ‘About you’ section');
                };

                var checkStep1 = function () {
                    if (!cvTarget2.classList.contains('cv-show')) {
                        setTimeout(function () {
                            var titleValid = cvTarget1.querySelector('input[name="title"][checked]') ? true : false;
                            var firstNameValid = firstName.value.length !== '' ? true : false;
                            var lastNameValid = lastName.value !== '' ? true : false;
                            var dob1Valid = dob1.value !== '' ? true : false;
                            var dob2Valid = dob2.value !== '' ? true : false;
                            var dob3Valid = dob3.value !== '' ? true : false;
                            var emailValid = email.value !== '' ? true : false;

                            if (titleValid && firstNameValid && lastNameValid && dob1Valid && dob2Valid && dob3Valid && emailValid) {
                                updateToStep2();
                            }
                        }, 50);
                    }
                };

                var elements = [];

                var target1Inputs = cvTarget1.querySelectorAll('input');

                for (var t = 0; t < target1Inputs.length; t++) {
                    elements.push(target1Inputs[t]);
                }

                for (var i = 0; i < elements.length; i++) {
                    elements[i].addEventListener('click', checkStep1);
                    elements[i].addEventListener('input', checkStep1);
                    elements[i].addEventListener('keyup', checkStep1);
                }

                // Show step 3 when step 2 is complete
                var updateToStep3 = function () {
                    document.querySelector('.cv_2-1_steps .cv-steps').classList.remove('cv-steps-2');
                    document.querySelector('.cv_2-1_steps .cv-steps').classList.add('cv-steps-3');
                    document.querySelector('.CONV-POL-2-1 form .formsect:nth-child(4)').classList.add('cv-show');

                    // Tracking
                    window.s_posc_gi('rmgpostofficecoukprod').tl(this, 'o', 'POL 2.1 Completes ‘Where you live’ section');
                };

                var checkStep2 = function () {
                    if (!cvTarget3.classList.contains('cv-show')) {
                        setTimeout(function () {
                            var residentValid = cvTarget2.querySelector('input[name="ukResidencyCode"][checked]') ? true : false;
                            var statusValid = cvTarget2.querySelector('input[name="residentialStatusCode"][checked]') ? true : false;

                            if (residentValid && statusValid && addressValid) {
                                updateToStep3();
                            }
                        }, 50);
                    }
                };

                var elements2 = [];

                var target2Inputs = cvTarget2.querySelectorAll('input');

                for (var t = 0; t < target2Inputs.length; t++) {
                    elements2.push(target2Inputs[t]);
                }

                var addressSection = cvTarget2.querySelector('#currentAddressHead').parentNode;

                elements2.push(addressSection);

                for (var v = 0; v < elements2.length; v++) {
                    elements2[v].addEventListener('click', checkStep2);
                    elements2[v].addEventListener('input', checkStep2);
                    elements2[v].addEventListener('keyup', checkStep2);
                }

                var addressValid = false;

                var checkForAddressInterval = setInterval(function () {
                    if (cvTarget2.querySelector('#currentAddressHead').parentNode.querySelector('table')) {
                        if (!cvTarget2.querySelector('#previousAddressHead')) {
                            if (cvTarget2.querySelector('#currentAddressHead').parentNode.querySelector('table').querySelectorAll('tr').length > 3) {
                                clearInterval(checkForAddressInterval);

                                addressValid = true;

                                checkStep2();
                            }
                        } else if (cvTarget2.querySelector('#previousAddressHead').parentNode.querySelector('table') &&
                            cvTarget2.querySelector('#previousAddressHead').parentNode.querySelector('table').querySelectorAll('tr').length > 3) {
                            clearInterval(checkForAddressInterval);

                            addressValid = true;

                            checkStep2();
                        }
                    }
                }, 100);

                // Check for step 3 complete
                var updateToStep4 = function () {
                    cvTarget4.classList.add('cv-show');
                    cvTarget5.classList.add('cv-show');
                    cvTargetButton.classList.add('cv-show');

                    // Tracking
                    window.s_posc_gi('rmgpostofficecoukprod').tl(this, 'o', 'POL 2.1 Completes ‘Work and finances’ section');
                };

                var target3Shown = false;

                var checkStep3 = function () {
                    if (!target3Shown) {
                        setTimeout(function () {
                            var employmentStatusValid = cvTarget3.querySelector('input[name="employmentStatusCode"][checked]') ? true : false;
                            var dependantValid = cvTarget3.querySelector('input[name="numberOfDependents"][checked]') ? true : false;
                            var income = cvTarget3.querySelector('input#incomeAmount');
                            var incomeValid = false;

                            if (income && income.value.length > 0) {
                                incomeValid = true;
                            }

                            var monthly = cvTarget3.querySelector('input#monthlyOutgoings');
                            var monthylValid = false;

                            if (monthly && monthly.value.length > 0) {
                                monthylValid = true;
                            }

                            if (employmentStatusValid && dependantValid && incomeValid && monthylValid) {
                                target3Shown = true;

                                updateToStep4();
                            }
                        }, 50);
                    }
                };

                var elements3 = [];

                var section3Inputs = cvTarget3.querySelectorAll('input');

                for (var t = 0; t < section3Inputs.length; t++) {
                    elements3.push(section3Inputs[t]);
                }

                for (var r = 0; r < elements3.length; r++) {
                    elements3[r].addEventListener('click', checkStep3);
                    elements3[r].addEventListener('input', checkStep3);
                    elements3[r].addEventListener('keyup', checkStep3);
                }

                // Show/hide the progress bar
                var sticky = document.querySelector('.cv_2-1_steps');
                var quickCheckForm = document.querySelector('form');
                var y = document.scrollingElement || document.documentElement;

                var checkBounds = function () {
                    var startOfBounds = quickCheckForm.offsetTop - 200;
                    var endOfBounds = cvTarget4.offsetTop > 0 ? cvTarget4.offsetTop - 190 : quickCheckForm.offsetTop + quickCheckForm.getBoundingClientRect().height - 190;

                    if (y.scrollTop > startOfBounds && y.scrollTop < endOfBounds) {
                        if (!sticky.classList.contains('cv-show')) {
                            sticky.classList.add('cv-show');
                        }
                    } else {
                        sticky.classList.remove('cv-show');
                    }
                }

                checkBounds();

                window.addEventListener('scroll', checkBounds);

                // Move the window higher up when 'check now' CTA is clicked so that the correct input is shown
                cvTargetButton.addEventListener('click', function () {
                    setTimeout(function () {
                        var scrollTarget = document.scrollingElement || document.documentElement;
                        var scrollTo = scrollTarget.scrollTop - 190;

                        if (typeof window.scrollTo !== 'undefined') {
                            window.scrollTo({ top: scrollTo, behavior: 'smooth' });
                        } else {
                            scrollTarget.scrollTop = scrollTo;
                        }
                    }, 860);
                });
            }

            // This code will be the same for all experiments (we need to decide on a naming convention for "link" and stick with it)
            function triggerIntegrations() {
                experimentIntegrations.adobeAnalytics({
                    link: 'Conversion.com Experience Optimisation',
                    account: 'rmgpostofficecoukprod'
                });

                experimentIntegrations.sessionCam({
                    slot: 'CRO Experience'
                });

                // Click tracking
                window.springBoard.on('mousedown', 'button#submitBtn', function (e) {
                    window.s_posc_gi('rmgpostofficecoukprod').tl(this, 'o', 'POL 2.1 Check now Final CTA clicks');
                });

                window.springBoard.on('click', 'button#submitBtn', function (e) {
                    window.s_posc_gi('rmgpostofficecoukprod').tl(this, 'o', 'POL 2.1 Check now Final CTA clicks');
                });
            }

            function init() {
                if (!document.documentElement.classList.contains(experience.id)) {
                    document.documentElement.classList.add(experience.id);
                    experiment();
                }
            }

            return {
                init: init
            };
        })();

        var experimentUtils = new window.OptimisationExperiment.Utils(experience);
        var experimentIntegrations = new window.OptimisationExperiment.Integrations(experience);

        experimentUtils.logger('Script Started');

        setTimeout(function () {
            experimentUtils.waitUntilTrue({
                timeout: 7000,
                hide: 'body > nav, body > div, body > footer',
                checker: function () {
                    var cvTargetSections = document.querySelectorAll('form .formsect');

                    if (cvTargetSections.length > 2) {
                        cvTarget1 = cvTargetSections[0];
                        cvTarget2 = cvTargetSections[1];
                        cvTarget3 = cvTargetSections[2];
                    }


                    cvTarget4 = document.querySelector('#permissions');
                    cvTarget5 = document.querySelector('#tcs');
                    cvTargetButton = document.querySelector('button#submitBtn');

                    if (cvTarget1) {
                        firstName = cvTarget1.querySelector('input#firstName');
                        lastName = cvTarget1.querySelector('input#lastName');
                        dob1 = cvTarget1.querySelector('input#birthDateDay');
                        dob2 = cvTarget1.querySelector('input#birthDateMonth');
                        dob3 = cvTarget1.querySelector('input#birthDateYear');
                        email = cvTarget1.querySelector('input#emailAddress');
                    }

                    if (cvTarget2) {
                        currentAddress = cvTarget2.querySelector('#currentAddressHead');
                    }

                    return (cvTarget1 && cvTarget2 && cvTarget3 && cvTarget4 && cvTarget5 && cvTargetButton &&
                        firstName && lastName && dob1 && dob2 && dob3 && email && currentAddress);
                },
                stopper: function () {
                    return false;
                },
                success: function () {
                    VARIATION.init();
                },
                fail: function () {
                    experimentUtils.logger('Fail');
                }
            });
        }, 200);
    })({
        // This code will be updated for each experiment/variation (we need to decide on a naming convention and stick with it)
        name: 'POL 2.1 - [Credit Cards] Eligibility Checker Investment - Variation',
        id: 'CONV-POL-2-1',
        page: 'POL-2-1 - Credit Cards - Eligibility Checker Investment',
        redirect: false,
        log: 'console',
    });
</script>
